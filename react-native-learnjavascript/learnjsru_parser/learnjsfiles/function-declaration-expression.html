
		<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=yes, minimum-scale=1.0">
		<link rel="stylesheet" type="text/css" href="./styles.css">
		<link rel="stylesheet" type="text/css" href="./prism.css">
		<script src="./prism.js"></script>
		</head><body><div class="page__inner"><main class="main main_width-limit"><article itemscope="" itemtype="http://schema.org/TechArticle"><meta content="Функциональные выражения" itemprop="name"><div itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta content="iliakan@gmail.com" itemprop="email"><meta content="Ilya Kantor" itemprop="name"/></meta></div><div itemprop="articleBody"><p>В JavaScript функция является значением, таким же как строка или число.</p>
<p>Как и любое значение, объявленную функцию можно вывести, вот так:</p>
<div class="code-example" data-highlight-block="4-4" data-trusted="1">
<div class="codebox code-example__codebox">
<div class="toolbar codebox__toolbar">
<div class="toolbar__tool">
<a class="toolbar__button toolbar__button_run" data-action="run" href="#" title="выполнить"></a>
</div>
<div class="toolbar__tool">
<a class="toolbar__button toolbar__button_edit" data-action="edit" href="#" target="_blank" title="открыть в песочнице"></a>
</div>
</div>
<div class="codebox__code" data-code="1">
<pre class="line-numbers language-javascript"><code class="language-javascript">function sayHi() {
  alert( "Привет" );
}

alert( sayHi ); // выведет код функции</code></pre>
</div>
</div>
</div><p>Обратим внимание на то, что в последней строке после <code>sayHi</code> нет скобок. То есть, функция не вызывается, а просто выводится на экран.</p>
<p><strong>Функцию можно скопировать в другую переменную:</strong></p>
<div class="code-example" data-trusted="1">
<div class="codebox code-example__codebox">
<div class="toolbar codebox__toolbar">
<div class="toolbar__tool">
<a class="toolbar__button toolbar__button_run" data-action="run" href="#" title="выполнить"></a>
</div>
<div class="toolbar__tool">
<a class="toolbar__button toolbar__button_edit" data-action="edit" href="#" target="_blank" title="открыть в песочнице"></a>
</div>
</div>
<div class="codebox__code" data-code="1">
<pre class="line-numbers language-javascript"><code class="language-javascript">function sayHi() {   // (1)
  alert( "Привет" );
}

var func = sayHi;    // (2)
func(); // Привет    // (3)

sayHi = null;
sayHi();             // ошибка (4)</code></pre>
</div>
</div>
</div><ol>
<li>Объявление <code>(1)</code> как бы говорит интерпретатору "создай функцию и помести её в переменную <code>sayHi</code></li>
<li>В строке <code>(2)</code> мы копируем функцию в новую переменную <code>func</code>. Ещё раз обратите внимание: после <code>sayHi</code> нет скобок. Если бы они были, то вызов <code>var func = sayHi()</code> записал бы в <code>func</code> <em>результат</em> работы <code>sayHi()</code> (кстати, чему он равен? правильно, <code>undefined</code>, ведь внутри <code>sayHi</code> нет <code>return</code>).</li>
<li>На момент <code>(3)</code> функцию можно вызывать и как <code>sayHi()</code> и как <code>func()</code></li>
<li>…Однако, в любой момент значение переменной можно поменять. При этом, если оно не функция, то вызов <code>(4)</code> выдаст ошибку.</li>
</ol>
<p>Обычные значения, такие как числа или строки, представляют собой <em>данные</em>. А функцию можно воспринимать как <em>действие</em>.</p>
<p>Это действие можно запустить через скобки <code>()</code>, а можно и скопировать в другую переменную, как было продемонстрировано выше.</p>
<h2><a class="main__anchor" href="#function-expression" name="function-expression">Объявление Function Expression</a></h2><p>Существует альтернативный синтаксис для объявления функции, который ещё более наглядно показывает, что функция – это всего лишь разновидность значения переменной.</p>
<p>Он называется «Function Expression» (функциональное выражение) и выглядит так:</p>
<div class="code-example" data-trusted="1">
<div class="codebox code-example__codebox">
<div class="toolbar codebox__toolbar">
<div class="toolbar__tool">
<a class="toolbar__button toolbar__button_run" data-action="run" href="#" title="выполнить"></a>
</div>
<div class="toolbar__tool">
<a class="toolbar__button toolbar__button_edit" data-action="edit" href="#" target="_blank" title="открыть в песочнице"></a>
</div>
</div>
<div class="codebox__code" data-code="1">
<pre class="line-numbers language-javascript"><code class="language-javascript">var f = function(параметры) {
  // тело функции
};</code></pre>
</div>
</div>
</div><p>Например:</p>
<div class="code-example" data-trusted="1">
<div class="codebox code-example__codebox">
<div class="toolbar codebox__toolbar">
<div class="toolbar__tool">
<a class="toolbar__button toolbar__button_run" data-action="run" href="#" title="выполнить"></a>
</div>
<div class="toolbar__tool">
<a class="toolbar__button toolbar__button_edit" data-action="edit" href="#" target="_blank" title="открыть в песочнице"></a>
</div>
</div>
<div class="codebox__code" data-code="1">
<pre class="line-numbers language-javascript"><code class="language-javascript">var sayHi = function(person) {
  alert( "Привет, " + person );
};

sayHi('Вася');</code></pre>
</div>
</div>
</div><h2><a class="main__anchor" href="#сравнение-с-function-declaration" name="сравнение-с-function-declaration">Сравнение с Function Declaration</a></h2><p>«Классическое» объявление функции, о котором мы говорили до этого, вида <code>function имя(параметры) {...}</code>, называется в спецификации языка «Function Declaration».</p>
<ul>
<li><em>Function Declaration</em> – функция, объявленная в основном потоке кода.</li>
<li><em>Function Expression</em> – объявление функции в контексте какого-либо выражения, например присваивания.</li>
</ul>
<p>Несмотря на немного разный вид, по сути две эти записи делают одно и то же:</p>
<div class="code-example" data-trusted="1">
<div class="codebox code-example__codebox">
<div class="codebox__code" data-code="1">
<pre class="line-numbers language-javascript"><code class="language-javascript">// Function Declaration
function sum(a, b) {
  return a + b;
}

// Function Expression
var sum = function(a, b) {
  return a + b;
}</code></pre>
</div>
</div>
</div><p>Оба этих объявления говорят интерпретатору: "объяви переменную <code>sum</code>, создай функцию с указанными параметрами и кодом и сохрани её в <code>sum</code>".</p>
<p><strong>Основное отличие между ними: функции, объявленные как Function Declaration, создаются интерпретатором до выполнения кода.</strong></p>
<p>Поэтому их можно вызвать <em>до</em> объявления, например:</p>
<div class="code-example" data-highlight-block="0-0" data-refresh="1" data-trusted="0">
<div class="codebox code-example__codebox">
<div class="toolbar codebox__toolbar">
<div class="toolbar__tool">
<a class="toolbar__button toolbar__button_run" data-action="run" href="#" title="выполнить"></a>
</div>
<div class="toolbar__tool">
<a class="toolbar__button toolbar__button_edit" data-action="edit" href="#" target="_blank" title="открыть в песочнице"></a>
</div>
</div>
<div class="codebox__code" data-code="1">
<pre class="line-numbers language-javascript"><code class="language-javascript">sayHi("Вася"); // Привет, Вася

function sayHi(name) {
  alert( "Привет, " + name );
}</code></pre>
</div>
</div>
</div><p>А если бы это было объявление Function Expression, то такой вызов бы не сработал:</p>
<div class="code-example" data-highlight-block="0-0" data-refresh="1" data-trusted="0">
<div class="codebox code-example__codebox">
<div class="toolbar codebox__toolbar">
<div class="toolbar__tool">
<a class="toolbar__button toolbar__button_run" data-action="run" href="#" title="выполнить"></a>
</div>
<div class="toolbar__tool">
<a class="toolbar__button toolbar__button_edit" data-action="edit" href="#" target="_blank" title="открыть в песочнице"></a>
</div>
</div>
<div class="codebox__code" data-code="1">
<pre class="line-numbers language-javascript"><code class="language-javascript">sayHi("Вася"); // ошибка!

var sayHi = function(name) {
  alert( "Привет, " + name );
}</code></pre>
</div>
</div>
</div><p>Это из-за того, что JavaScript перед запуском кода ищет в нём Function Declaration (их легко найти: они не являются частью выражений и начинаются со слова <code>function</code>) и обрабатывает их.</p>
<p>А Function Expression создаются в процессе выполнении выражения, в котором созданы, в данном случае – функция будет создана при операции присваивания <code>sayHi = function...</code></p>
<p>Как правило, возможность Function Declaration вызвать функцию до объявления – это удобно, так как даёт больше свободы в том, как  организовать свой код.</p>
<p>Можно расположить функции внизу, а их вызов – сверху или наоборот.</p>
<h3><a class="main__anchor" href="#bad-conditional-declaration" name="bad-conditional-declaration">Условное объявление функции</a></h3><p>В некоторых случаях «дополнительное удобство» Function Declaration может сослужить плохую службу.</p>
<p>Например, попробуем, в зависимости от условия, объявить функцию <code>sayHi</code> по-разному:</p>
<div class="code-example" data-no-strict="1" data-trusted="1">
<div class="codebox code-example__codebox">
<div class="toolbar codebox__toolbar">
<div class="toolbar__tool">
<a class="toolbar__button toolbar__button_run" data-action="run" href="#" title="выполнить"></a>
</div>
<div class="toolbar__tool">
<a class="toolbar__button toolbar__button_edit" data-action="edit" href="#" target="_blank" title="открыть в песочнице"></a>
</div>
</div>
<div class="codebox__code" data-code="1">
<pre class="line-numbers language-javascript"><code class="language-javascript">var age = +prompt("Сколько вам лет?", 20);

if (age &gt;= 18) {
  function sayHi() {
    alert( 'Прошу вас!' );
  }
} else {
  function sayHi() {
    alert( 'До 18 нельзя' );
  }
}

sayHi();</code></pre>
</div>
</div>
</div><p>Function Declaration при <code>use strict</code> видны только внутри блока, в котором объявлены. Так как код в учебнике выполняется в режиме <code>use strict</code>, то будет ошибка.</p>
<p>А что, если использовать Function Expression?</p>
<div class="code-example" data-trusted="1">
<div class="codebox code-example__codebox">
<div class="toolbar codebox__toolbar">
<div class="toolbar__tool">
<a class="toolbar__button toolbar__button_run" data-action="run" href="#" title="выполнить"></a>
</div>
<div class="toolbar__tool">
<a class="toolbar__button toolbar__button_edit" data-action="edit" href="#" target="_blank" title="открыть в песочнице"></a>
</div>
</div>
<div class="codebox__code" data-code="1">
<pre class="line-numbers language-javascript"><code class="language-javascript">var age = prompt('Сколько вам лет?');

var sayHi;

if (age &gt;= 18) {
  sayHi = function() {
    alert( 'Прошу Вас!' );
  }
} else {
  sayHi = function() {
    alert( 'До 18 нельзя' );
  }
}

sayHi();</code></pre>
</div>
</div>
</div><p>Или даже так:</p>
<div class="code-example" data-trusted="1">
<div class="codebox code-example__codebox">
<div class="toolbar codebox__toolbar">
<div class="toolbar__tool">
<a class="toolbar__button toolbar__button_run" data-action="run" href="#" title="выполнить"></a>
</div>
<div class="toolbar__tool">
<a class="toolbar__button toolbar__button_edit" data-action="edit" href="#" target="_blank" title="открыть в песочнице"></a>
</div>
</div>
<div class="codebox__code" data-code="1">
<pre class="line-numbers language-javascript"><code class="language-javascript">var age = prompt('Сколько вам лет?');

var sayHi = (age &gt;= 18) ?
  function() { alert('Прошу Вас!');  } :
  function() { alert('До 18 нельзя'); };

sayHi();</code></pre>
</div>
</div>
</div><p>Оба этих варианта работают правильно, поскольку, в зависимости от условия, создаётся именно та функция, которая нужна.</p>
<h3><a class="main__anchor" href="#анонимные-функции" name="анонимные-функции">Анонимные функции</a></h3><p>Взглянем ещё на один пример – функцию <code>ask(question, yes, no)</code> с тремя параметрами:</p>
<dl>
<dt><code>question</code></dt>
<dd>Строка-вопрос</dd>
<dt><code>yes</code></dt>
<dd>Функция</dd>
<dt><code>no</code></dt>
<dd>Функция</dd>
</dl>
<p>Она выводит вопрос на подтверждение <code>question</code> и, в зависимости от согласия пользователя, вызывает функцию <code>yes()</code> или <code>no()</code>:</p>
<div class="code-example" data-highlight-block="0-3" data-trusted="1">
<div class="codebox code-example__codebox">
<div class="toolbar codebox__toolbar">
<div class="toolbar__tool">
<a class="toolbar__button toolbar__button_run" data-action="run" href="#" title="выполнить"></a>
</div>
<div class="toolbar__tool">
<a class="toolbar__button toolbar__button_edit" data-action="edit" href="#" target="_blank" title="открыть в песочнице"></a>
</div>
</div>
<div class="codebox__code" data-code="1">
<pre class="line-numbers language-javascript"><code class="language-javascript">function ask(question, yes, no) {
    if (confirm(question)) yes()
    else no();
  }

function showOk() {
  alert( "Вы согласились." );
}

function showCancel() {
  alert( "Вы отменили выполнение." );
}

// использование
ask("Вы согласны?", showOk, showCancel);</code></pre>
</div>
</div>
</div><p>Какой-то очень простой код, не правда ли? Зачем, вообще, может понадобиться такая <code>ask</code>?</p>
<p>…Оказывается, при работе со страницей такие функции как раз очень востребованы, только вот спрашивают они не простым <code>confirm</code>, а выводят более красивое окно с вопросом и могут интеллектуально обработать ввод посетителя. Но это всё потом, когда перейдём к работе с интерфейсом.</p>
<p>Здесь же обратим внимание на то, что то же самое можно написать более коротко:</p>
<div class="code-example" data-highlight-block="5-9" data-trusted="1">
<div class="codebox code-example__codebox">
<div class="toolbar codebox__toolbar">
<div class="toolbar__tool">
<a class="toolbar__button toolbar__button_run" data-action="run" href="#" title="выполнить"></a>
</div>
<div class="toolbar__tool">
<a class="toolbar__button toolbar__button_edit" data-action="edit" href="#" target="_blank" title="открыть в песочнице"></a>
</div>
</div>
<div class="codebox__code" data-code="1">
<pre class="line-numbers language-javascript"><code class="language-javascript">function ask(question, yes, no) {
  if (confirm(question)) yes()
  else no();
}

ask(
  "Вы согласны?",
  function() { alert("Вы согласились."); },
  function() { alert("Вы отменили выполнение."); }
);</code></pre>
</div>
</div>
</div><p>Здесь функции объявлены прямо внутри вызова <code>ask(...)</code>, даже без присвоения им имени.</p>
<p><strong>Функциональное выражение, которое не записывается в переменную, называют <a href="http://ru.wikipedia.org/wiki/%D0%90%D0%BD%D0%BE%D0%BD%D0%B8%D0%BC%D0%BD%D0%B0%D1%8F_%D1%84%D1%83%D0%BD%D0%BA%D1%86%D0%B8%D1%8F">анонимной функцией</a>.</strong></p>
<p>Действительно, зачем нам записывать функцию в переменную, если мы не собираемся вызывать её ещё раз? Можно просто объявить непосредственно там, где функция нужна.</p>
<p>Такого рода код возникает естественно, он соответствует «духу» JavaScript.</p>
<h2><a class="main__anchor" href="#new-function" name="new-function">new Function</a></h2><p>Существует ещё один способ создания функции, который используется очень редко, но упомянем и его для полноты картины.</p>
<p>Он позволяет создавать функцию полностью «на лету» из строки, вот так:</p>
<div class="code-example" data-trusted="1">
<div class="codebox code-example__codebox">
<div class="toolbar codebox__toolbar">
<div class="toolbar__tool">
<a class="toolbar__button toolbar__button_run" data-action="run" href="#" title="выполнить"></a>
</div>
<div class="toolbar__tool">
<a class="toolbar__button toolbar__button_edit" data-action="edit" href="#" target="_blank" title="открыть в песочнице"></a>
</div>
</div>
<div class="codebox__code" data-code="1">
<pre class="line-numbers language-javascript"><code class="language-javascript">var sum = new Function('a,b', ' return a+b; ');

var result = sum(1, 2);
alert( result ); // 3</code></pre>
</div>
</div>
</div><p>То есть, функция создаётся вызовом <code>new Function(params, code)</code>:</p>
<dl>
<dt><code>params</code></dt>
<dd>Параметры функции через запятую в виде строки.</dd>
<dt><code>code</code></dt>
<dd>Код функции в виде строки.</dd>
</dl>
<p>Таким образом можно конструировать функцию, код которой неизвестен на момент написания программы, но строка с ним генерируется или подгружается динамически во время её выполнения.</p>
<p>Пример использования – динамическая компиляция шаблонов на JavaScript, мы встретимся с ней позже, при работе с интерфейсами.</p>
<h2><a class="main__anchor" href="#итого" name="итого">Итого</a></h2><p>Функции в JavaScript являются значениями. Их можно присваивать, передавать, создавать в любом месте кода.</p>
<ul>
<li>Если функция объявлена в <em>основном потоке кода</em>, то это Function Declaration.</li>
<li>Если функция создана как <em>часть выражения</em>, то это Function Expression.</li>
</ul>
<p>Между этими двумя основными способами создания функций есть следующие различия:</p>
<table class="table-bordered">
<tr>
<th></th>
<th>Function Declaration</th>
<th>Function Expression</th>
</tr>
<tr>
<td>Время создания</td>
<td>До выполнения первой строчки кода.</td>
<td>Когда управление достигает строки с функцией.</td>
</tr>
<tr>
<td>Можно вызвать до объявления </td>
<td><code>Да</code> (т.к. создаётся заранее)</td>
<td><code>Нет</code></td>
</tr>
<tr>
<td>Условное объявление в <code>if</code></td>
<td><code>Не работает</code></td>
<td><code>Работает</code></td>
</tr>
</table>
<p>Иногда в коде начинающих разработчиков можно увидеть много Function Expression. Почему-то, видимо, не очень понимая происходящее, функции решают создавать как <code>var func = function()</code>, но в большинстве случаев обычное объявление функции – лучше.</p>
<p><strong>Если нет явной причины использовать Function Expression – предпочитайте Function Declaration.</strong></p>
<p>Сравните по читаемости:</p>
<div class="code-example" data-trusted="1">
<div class="codebox code-example__codebox">
<div class="codebox__code" data-code="1">
<pre class="line-numbers language-javascript"><code class="language-javascript">// Function Expression
var f = function() { ... }

// Function Declaration
function f() { ... }</code></pre>
</div>
</div>
</div><p>Function Declaration короче и лучше читается. Дополнительный бонус – такие функции можно вызывать до того, как они объявлены.</p>
<p>Используйте Function Expression только там, где это действительно нужно и удобно.</p>
</div></meta></article></main></div></body></html>